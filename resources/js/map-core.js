
document.addEventListener("DOMContentLoaded", function () {
  const map = new kakao.maps.Map(document.getElementById('map'), {
    center: new kakao.maps.LatLng(36.3504, 127.3845),
    level: 4
  });

  let geojsonData = null;
  let polygonData = [];
  let markerData = [];
  let isPolygonVisible = false;
  let isMarkerVisible = false;
  let currentRegion = 'ì„œêµ¬';  // ì´ˆê¸° ì„ íƒ êµ¬
  let polygons = [];      // ê·¸ë ¤ì§„ í´ë¦¬ê³¤ ê°ì²´ë“¤
  let searchMarkers = [];


  const noiseIcon = new kakao.maps.MarkerImage(
    '/img/noise.png', new kakao.maps.Size(52, 52)
  );
  
  // ë…¸í›„ë„ í´ë¦¬ê³¤ ìƒ‰ìƒ ê¸°ì¤€ í•¨ìˆ˜
  function getColorByYear(year) {
      if (!year || year === 0) return '#FFFFFF';
      const currentYear = new Date().getFullYear();
      const age = currentYear - year;

      if (age <= 5) return '#3498db';     // ë§¤ìš° ì–‘í˜¸ (0~5ë…„)
      if (age <= 10) return '#2ecc71';    // ì–‘í˜¸ (6~10ë…„)
      if (age <= 20) return '#f1c40f';    // ë³´í†µ (11~20ë…„)
      if (age <= 30) return '#e67e22';    // ë…¸í›„ (21~30ë…„)
      return '#e74c3c';                   // ë§¤ìš° ë…¸í›„ (31ë…„ ì´ìƒ)
  }
	

	window.togglePolygons = function () {
		if (isPolygonVisible) {
		    // í´ë¦¬ê³¤ì´ ë³´ì´ëŠ” ìƒíƒœ â†’ ìˆ¨ê¸°ê¸°
		    polygonData.forEach(polygon => polygon.setMap(null));
		    polygonData = [];
		    isPolygonVisible = false;
		    return;
		}
		const center = map.getCenter();  // Kakao Map ê°ì²´ì—ì„œ ì¤‘ì‹¬ ì¢Œí‘œ ê°€ì ¸ì˜´
		const lat = center.getLat();
		const lng = center.getLng();
		const geocoder = new kakao.maps.services.Geocoder();

		const coord = new kakao.maps.LatLng(lat, lng);
		geocoder.coord2RegionCode(coord.getLng(), coord.getLat(), function(result, status) {
		  if (status === kakao.maps.services.Status.OK) {
		    // ì¼ë°˜ì ìœ¼ë¡œ í–‰ì •ë™ëª…ì€ result[0].region_3depth_nameì— ìœ„ì¹˜
		    const dong = result[0].region_3depth_name;
		    console.log("í˜„ì¬ ì§€ë„ ì¤‘ì‹¬ì˜ ë™:", dong);
			alert(dong + " ë…¸í›„ë„");
			fetch(`/geojson?dong=${encodeURIComponent(dong)}`)
			      .then(res => res.json())
			      .then(data => {
			        geojsonData = data;
			        showPolygons();
		 	});
		  }
		});
	};


	window.showPolygons = function () {
	  if (!geojsonData) return;
	  clearPolygons();

	  geojsonData.features.forEach(f => {
	    const addr = `${f.properties.A4 || ''} ${f.properties.A5 || ''}`.trim();
	    const coords = f.geometry.type === 'Polygon'
	      ? f.geometry.coordinates[0].map(c => new kakao.maps.LatLng(c[1], c[0]))
	      : f.geometry.coordinates[0][0].map(c => new kakao.maps.LatLng(c[1], c[0]));

	    const year = parseInt((f.properties.A13 || '').substring(0, 4)) || 0;
	    const polygon = new kakao.maps.Polygon({
	      path: coords,
	      strokeWeight: 1,
	      strokeColor: '#333',
	      fillColor: getColorByYear(year),
	      fillOpacity: 0.6
	    });
	    polygon.setMap(map);

	    kakao.maps.event.addListener(polygon, 'click', () => {
	      alert(`ì£¼ì†Œ: ${addr}\nì¤€ê³µì¼ì: ${f.properties.A13 || 'ì—†ìŒ'}`);
	    });

	    polygonData.push(polygon);
	  });
	  isPolygonVisible = true;
	};



  window.toggleHelp = function () {
    const helpOverlay = document.getElementById('helpOverlay');
    if (helpOverlay.style.display === 'none' || helpOverlay.style.display === '') {
      helpOverlay.style.display = 'block';
    } else {
      helpOverlay.style.display = 'none';
    }
  };
  
  window.resetMap = function () {
      clearPolygons();

      // ê¸°ì¡´ ê²€ìƒ‰ ë§ˆì»¤ ëª¨ë‘ ì œê±°
      searchMarkers.forEach(marker => marker.setMap(null));
      searchMarkers = [];

      document.getElementById('searchInput').value = '';
      map.setLevel(4);
      map.setCenter(new kakao.maps.LatLng(36.3504, 127.3845));
  };
  
  function clearPolygons() {
    polygons.forEach(polygon => {
      polygon.setMap(null);
    });
    polygonData.forEach(polygon => {
      polygon.setMap(null);
    });
    polygons = [];
    polygonData = [];  
  }

  
  function getColorByDb(db) {
    if (db >= 90) return "#d73027";
    if (db >= 85) return "#fc8d59";
    if (db >= 80) return "#fee08b";
    if (db >= 75) return "#d9ef8b";
    if (db >= 70) return "#91cf60";
    return "#1a9850";
  }

  function createNoiseOverlay(data) {
    const level = data.db;
    const color = getColorByDb(level);
    const exceedText = level > 65
      ? "ğŸ“â€œì¼ë°˜ì£¼ê±°ì§€ì—­ ì£¼ê°„ ê¸°ì¤€(65dB)â€ì„ ì´ˆê³¼í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.<br> ì´ ì •ë„ì˜ ì†ŒìŒì€ ì¼ë°˜ì ì¸ ëŒ€í™”ë³´ë‹¤ í¬ë©°,<br>ì¥ì‹œê°„ ë…¸ì¶œ ì‹œ ë¶ˆì¾Œê°ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      : "ê¸°ì¤€ì¹˜ ì´ë‚´ì…ë‹ˆë‹¤.";

    return `
    <div style="width: 360px; background: white; border-radius: 12px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.4); font-family: 'Noto Sans KR'; position: relative;">
      <!-- X ë‹«ê¸° ë²„íŠ¼ -->
      <div onclick="closeOverlay()" style="position: absolute; top: 10px; right: 12px; cursor: pointer; font-size: 18px; font-weight: bold; color: #999;">Ã—</div>

      <div style="font-size: 18px; font-weight: bold;">${data.name}</div>
      <div style="font-size: 14px; color: #444;">${data.addr}</div>

      <div style="margin-top: 10px; display: flex; gap: 8px;">
        <div style="font-size: 13px; background: #eee; padding: 3px 10px; border-radius: 6px;">${data.zone} êµ¬ì—­</div>
  
        <div style="font-size: 13px; background: #444; color: white; padding: 3px 10px; border-radius: 6px;">${data.location}</div>
      </div>

      <div style="margin-top: 14px; font-weight: bold;">í˜„ì¬ ì†ŒìŒ ë‹¨ê³„</div>
      <div style="margin: 6px 0;">
        <span style="display: inline-block; background: ${color}; color: white; padding: 5px 10px; border-radius: 14px;">
          ${data.db} dB
        </span>
      </div>

      <div style="margin: 12px 0;">
        <div style="height: 10px; background: linear-gradient(to right, #1a9850, #91cf60, #d9ef8b, #fee08b, #fc8d59, #d73027); border-radius: 4px;"></div>
        <div style="display: flex; justify-content: space-between; font-size: 12px; margin-top: 4px;">
          <span>70(ê¸°ì¤€)</span><span>75</span><span>80</span><span>85</span><span>90+</span>
        </div>
      </div>

      <div style="font-size: 13px; color: #333; line-height: 1.5;">
        í˜„ì¬ ì¸¡ì •ëœ ì†ŒìŒì€ <b>${data.db}dB</b>ë¡œ,<br>
        ${exceedText}<br>
        
      </div>
    </div>`;
  }


  const overlay = new kakao.maps.CustomOverlay({ map: null });
  window.overlay = overlay; 
  const markerPoints = [
  {
    name: "ê°€ìˆ˜ì›ê²½ë¡œë‹¹ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê°€ìˆ˜ì›ë™ 643",
    x: 127.350801285859,
    y: 36.3026448845129,
    db: 55.2,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "LGí…”ë ˆì½¤",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëª©ì¤‘ë¡œ 40",
    x: 127.410141863085,
    y: 36.3371224736382,
    db: 63.19,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "S-OIL ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ì‚°ë¡œ 446",
    x: 127.398509564013,
    y: 36.3418609275787,
    db: 68.39,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "CUí¸ì˜ì  ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëŒ€ì¢…ë¡œ593ë²ˆê¸¸ 14",
    x: 127.417551845823,
    y: 36.3344856646544,
    db: 59.49,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ê±´ì–‘ëŒ€í•™êµ ì…êµ¬ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê³„ë°±ë¡œ 1059",
    x: 127.340956594358,
    y: 36.303146997072,
    db: 65.57,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ê°œë‚˜ë¦¬ì•„íŒŒíŠ¸ 106ë™ ë’·í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê³„ë£¡ë¡œ509ë²ˆê¸¸ 31",
    x: 127.382257756248,
    y: 36.3454124442612,
    db: 57.58,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "P&Cí…Œí¬ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ì‹ ì¼ë™ë¡œ67ë²ˆê¸¸ 24",
    x: 127.410856790293,
    y: 36.4407085767821,
    db: 64.21,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ê·¼ë¡œë³µì§€ê³µë‹¨ ëŒ€ì „ë³‘ì› ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë²•ë™ 286",
    x: 127.428314838619,
    y: 36.3672761545917,
    db: 57.5,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "ê±´ì–‘ëŒ€í•™êµ ì£¼ì°¨ì¥ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ë™ë¡œ 158",
    x: 127.34264048636,
    y: 36.3068221303823,
    db: 72.55,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ê´€ì €2ë™ ìš°ì²´êµ­ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ë¡œ 63",
    x: 127.328747389682,
    y: 36.2991026576442,
    db: 61.07,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "êµì´Œë¹Œë”© ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì§„ì ë¡œ 145",
    x: 127.317465186458,
    y: 36.3036515665546,
    db: 64.34,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ê·€ëšœë¼ë¯¸ë³´ì¼ëŸ¬ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë°°ì¬ë¡œ233ë²ˆê¸¸ 11",
    x: 127.369921373802,
    y: 36.3292309340394,
    db: 60.31,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "êµ¬ì•”ì–´ë¦°ì´ê³µì›",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ê³„ë£¡ë¡œ74ë²ˆê¸¸ 79-15",
    x: 127.338865321411,
    y: 36.3511434643144,
    db: 58.89,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "êµ­í† ì •ë³´ê³µì‚¬ ëŒ€ì „ë™ë¶€ì§€ì‚¬ ì •ë¬¸ ìš°ì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëŒ€í¥ë¡œ10ë²ˆê¸¸ 41",
    x: 127.417050322533,
    y: 36.3199658965274,
    db: 55.77,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë‚˜ë‚ ìš”ì–‘ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ íƒœì „ë¡œ 5",
    x: 127.430785088283,
    y: 36.3312014805297,
    db: 59.87,
    location: "ì¼ë°˜",
    zone: "ë¼"
  },
  {
    name: "ê¹€ë°¥ë‚˜ë¼ ë¬¸í™”2í˜¸ì ",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ì²œê·¼ë¡œ69ë²ˆê¸¸ 114",
    x: 127.405181357167,
    y: 36.3131829077184,
    db: 58.76,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ëŒ€ë¦¼ì•„íŒŒíŠ¸ 1ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ìš©í™”6ê¸¸ 21",
    x: 127.374824837963,
    y: 36.320409990841,
    db: 52.48,
    location: "ì¼ë°˜",
    zone: "ë¼"
  },
  {
    name: "ê¶ì „í•˜ì´ì¸  ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë³€ë™ì„œë¡œ6ë²ˆê¸¸ 14",
    x: 127.36985403582,
    y: 36.3303850672059,
    db: 54.62,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ë‰´ë”œì‚¬ì—… í˜„ì¥ì§€ì›ì„¼í„° ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì •ë¦¼ë¡œ24ë²ˆê¸¸ 24",
    x: 127.36757516528,
    y: 36.3025894376825,
    db: 55.03,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ë†ìˆ˜ì‚°ë„ë§¤ì‹œì¥ ì œ2ë¬¸ ìš°ì¸¡í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ë…¸ì€ë™ë¡œ 33",
    x: 127.320448810671,
    y: 36.3646432101597,
    db: 61.89,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ëŠ˜í‘¸ë¥¸ì•½êµ­ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ëŒ€ë•ëŒ€ë¡œ242ë²ˆê¸¸ 26",
    x: 127.380967481359,
    y: 36.354129777698,
    db: 58.42,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ëŒ€ë™íœíƒ€ë·°ì•„íŒŒíŠ¸ ì •ë¬¸ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ê³„ì¡±ë¡œ140ë²ˆê¸¸ 33",
    x: 127.446451511793,
    y: 36.3264816131916,
    db: 64.91,
    location: "ì¼ë°˜",
    zone: "ë‹¤"
  },
  {
    name: "ë” í• ì¸ë§ˆíŠ¸ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ íŒì•”ë™ 231-1",
    x: 127.460934229694,
    y: 36.3225542307098,
    db: 60.14,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ëŒ€ë•í…Œí¬ë…¸ë°¸ë¦¬5ë‹¨ì§€ 501ë™ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ë°°ìš¸2ë¡œ 42",
    x: 127.387077891016,
    y: 36.419117596929,
    db: 64.7,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ëŒ€ëŒ€ë¡œ ê°ìíƒ•ì¡±ë°œ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë‘”ì‚°ì¤‘ë¡œ134ë²ˆê¸¸ 21",
    x: 127.388135785117,
    y: 36.3590473628458,
    db: 62.96,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ëŒ€ì¼íƒ• ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ëŒ€í™”7ê¸¸ 21",
    x: 127.416065034406,
    y: 36.3650111410866,
    db: 57.16,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ëŒ€ì „ë™ì‚°ê³ ë“±í•™êµ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ë¬¸í™”ë™ 284-54",
    x: 127.404669395311,
    y: 36.3145911361228,
    db: 69.96,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ëŒ€ì–‘ë¹Œë¼ 103ë™ ë§ì€í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¹„ë˜ë™ë¡œ32ë²ˆê¸¸ 36",
    x: 127.452305138185,
    y: 36.3558754738655,
    db: 56.97,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ëŒ€ë•íì°¨ì‚¬ì—…ì†Œ ë§ì€í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ëŒ€í™”ë¡œ 80",
    x: 127.411853552382,
    y: 36.368398751123,
    db: 65.61,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ëŒ€ì „ ì¶œì…êµ­ì‚¬ë¬´ì†Œ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëª©ì¤‘ë¡œ26ë²ˆê¸¸ 7",
    x: 127.410992135542,
    y: 36.3366550552322,
    db: 60.87,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ëŒ€ì „ ì–‘ì§€ì´ˆë“±í•™êµ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ìŒì²­ë‹¹ë¡œ 45",
    x: 127.433249573371,
    y: 36.3657752552034,
    db: 61.45,
    location: "ì¼ë°˜",
    zone: "ë‹¤"
  },
  {
    name: "ëŒ€ì°½ì•„íŒŒíŠ¸ ì •ë¬¸ ìš°ì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë²šê½ƒê¸¸ 142",
    x: 127.424411879761,
    y: 36.4248030343645,
    db: 61.5,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë¡¯ë°ì—‘ìŠ¤í¬2ë‹¨ì§€ 206ë™ ë’·í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì—‘ìŠ¤í¬ë¡œ 448",
    x: 127.409202641349,
    y: 36.3975506025886,
    db: 61.99,
    location: "ì¼ë°˜",
    zone: "ë¼"
  },
  {
    name: "ëŒ€ì „ì²­ì‚¬ìì—°ë§ˆë‹¹ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë‘”ì‚°2ë™ 930",
    x: 127.384880534851,
    y: 36.3587592914894,
    db: 68.32,
    location: "ì¼ë°˜",
    zone: "ë¼"
  },
  {
    name: "ë™ì–‘ë¹Œë¼3ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ì‚°ì„±ë™ 306-2",
    x: 127.388007208051,
    y: 36.303580756701,
    db: 53.37,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "ëŒ€ì „ìš°ì²´êµ­ ì¢Œì¸¡í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ëŒ€ì „ë¡œ 753",
    x: 127.434644765543,
    y: 36.3270358411621,
    db: 68.26,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë„ë§ˆ1ë™ í–‰ì •ë³µì§€ì„¼í„° ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ë§ˆ3ê¸¸ 46",
    x: 127.381132043455,
    y: 36.3160241421466,
    db: 55.07,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ëŒ€ì „ì„œë¬¸êµíšŒ ì…êµ¬",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëŒ€ë‘”ì‚°ë¡œ373ë²ˆê¸¸ 39",
    x: 127.383946999299,
    y: 36.3030995124858,
    db: 53.6,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "ë”í´ë˜ì‹ ë¹Œë”© ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ í…Œí¬ë…¸ì¤‘ì•™ë¡œ 130",
    x: 127.397056256658,
    y: 36.4220732372196,
    db: 66.12,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë‘ìš¸ìƒ¤ë¸Œì¹¼êµ­ìˆ˜ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ íƒ„ë°©ë™ ë¬¸ì •ë¡œ90ë²ˆê¸¸ 15",
    x: 127.389531151523,
    y: 36.3459775385542,
    db: 58.05,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë„ì•ˆë¦°í’€í•˜ìš°ìŠ¤18ë‹¨ì§€ ì •ë¬¸ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ì•ˆë™ ë„ì•ˆë™ë¡œ 77",
    x: 127.349184951623,
    y: 36.3105945067565,
    db: 61.23,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ëŸ­í‚¤ìŠ¤í¬ì¸ í”„ë¼ì ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ì¤‘ë¦¬ì„œë¡œ 83",
    x: 127.422840888357,
    y: 36.3663511959505,
    db: 64.48,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë©•ì‹œì¹¸ ì–‘ë…ì¹˜í‚¨ ì•",
    addr: "ëŒ€ì „ ì„œêµ¬ ë™ì„œëŒ€ë¡œ 1017-2",
    x: 127.375085438375,
    y: 36.3324219477375,
    db: 70.15,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ë””ì—ì´ì¹˜ì¸í…Œë¦¬ì–´ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ì„ ë¹„ë§ˆì„ë¡œ 6",
    x: 127.446309035179,
    y: 36.3619997748366,
    db: 64.96,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ë“œë¦¼êµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê³„ë£¡ë¡œ662ë²ˆê¸¸ 21",
    x: 127.394020986024,
    y: 36.3360253352845,
    db: 53.29,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ë°±ì–µí”„ë¼ì ì¢Œì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì§€ì¡±ë¡œ148ë²ˆê¸¸ 39-29",
    x: 127.305680676706,
    y: 36.3782483482867,
    db: 62.94,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "ë¬¸ì¶©ì‚¬ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ìš©ìš´ë™ 356-2",
    x: 127.459874143774,
    y: 36.3243351599454,
    db: 54.79,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë§˜ìŠ¤í„°ì¹˜ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ê°€ì–‘ë™ 162-3",
    x: 127.451052672129,
    y: 36.347911929975,
    db: 67.3,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë°˜ë„ë¹Œë¼ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëª©ë™ 10-33",
    x: 127.40951604308,
    y: 36.3360423047411,
    db: 54.57,
    location: "ì¼ë°˜",
    zone: "ë¼"
  },
  {
    name: "ë°”ìš°ë°°ê¸°ì–´ë¦°ì´ê³µì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë²•ë™ 280-1",
    x: 127.424678007844,
    y: 36.3725894980762,
    db: 65.74,
    location: "ì¼ë°˜",
    zone: "ë‹¤"
  },
  {
    name: "ë§Œë…„ê³ êµ ë’·í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë§Œë…„ë¡œ 6",
    x: 127.372760292861,
    y: 36.3672667020544,
    db: 69.86,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "ë‘ìœ ë¹ˆìŠ¤ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì›ì‹ í¥ë‚¨ë¡œ42ë²ˆê¸¸ 5-37",
    x: 127.338399447388,
    y: 36.3378647675179,
    db: 66.55,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ë§ˆë¼ë³¸ê³µì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ë¬¸í™”ë¡œ99ë²ˆê¸¸ 5",
    x: 127.39619536502,
    y: 36.3126668037523,
    db: 54.93,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë°°ì¬ëŒ€í•™êµ ì‚°í•™í˜‘ë ¥ë‹¨ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ êµ¬ì¦‰ë¡œ48ë²ˆê¸¸ 46",
    x: 127.387351222086,
    y: 36.4324422760045,
    db: 71.12,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë³¼ë³´ëŒ€ë¦¬ì  ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ í•œë°­ëŒ€ë¡œ 1112",
    x: 127.421904708467,
    y: 36.3584359499755,
    db: 72.09,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì‚¼í˜¸ì•„íŒŒíŠ¸ 2ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ê³„ì¡±ë¡œ663ë²ˆê¸¸ 32",
    x: 127.425515749638,
    y: 36.3728217509616,
    db: 68.65,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë¶€ì¼ì§€ì—…ì‚¬ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì›”í‰ë¡œ 31-1",
    x: 127.360783067982,
    y: 36.3563409322972,
    db: 61.85,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë³´ì„±ë¹Œë”© ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ìš©ë‘ë™ 112-1",
    x: 127.406404871095,
    y: 36.3281296595833,
    db: 68.3,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë³µìš©ì‚¼ê±°ë¦¬ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ìœ ì„±ëŒ€ë¡œ 510",
    x: 127.321275618473,
    y: 36.341408172492,
    db: 71.87,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì‚¼ì–‘íŒ¨í‚¤ì§• ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ëŒ€ë•ëŒ€ë¡œ1417ë²ˆê¸¸ 47",
    x: 127.4044298605,
    y: 36.4487174511782,
    db: 60.97,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ë³´ì°½í•œì˜ì› ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ë³´ë¬¸ì‚°ë¡œ 44-1",
    x: 127.385488900598,
    y: 36.3043919531067,
    db: 68.2,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "ì‚¼ì„±ì•„íŒŒíŠ¸ 8ë™ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ê³„ë£¡ë¡œ 852",
    x: 127.408108325556,
    y: 36.323599498177,
    db: 60.77,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë¬¸í™”2ë™ìš°ì²´êµ­ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ë‹¹ë””ë¡œ6ë²ˆê¸¸ 98",
    x: 127.399415385812,
    y: 36.3078369653938,
    db: 58.49,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ìƒˆí•˜ëŠ˜êµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ì˜¤ì •ë™ 56-3",
    x: 127.41340865555,
    y: 36.3594328266235,
    db: 68.89,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì‚¼ì§„ì •ë°€ ë’¤í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ëŒ€í™”ë¡œ132ë²ˆê¸¸ 22",
    x: 127.406612122389,
    y: 36.3676822379458,
    db: 60.78,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ìƒ˜ë¨¸ë¦¬2ë‹¨ì§€ 204ë™ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë¬¸ì˜ˆë¡œ 174",
    x: 127.392058829862,
    y: 36.3630641988923,
    db: 74.13,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ìƒ˜ë¨¸ë¦¬ì•„íŒŒíŠ¸ 222ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì²­ì‚¬ë¡œ 281",
    x: 127.390997675009,
    y: 36.361769755787,
    db: 63.76,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì„¸ë¸ì¼ë ˆë¸ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ë‚¨ë¡œ25ë²ˆê¸¸ 8-4",
    x: 127.337672650561,
    y: 36.2951100367568,
    db: 59.78,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ìƒˆì†Œë§êµíšŒ ì¢Œì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ íƒ‘ë¦½ë¡œ29ë²ˆê¸¸ 21",
    x: 127.398877955477,
    y: 36.4109799356199,
    db: 60.04,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì„±ì‚°ìˆ˜ë„ì› ì…êµ¬",
    addr: "ëŒ€ì „ ìœ ì„±êµ¬ ë¶ìœ ì„±ëŒ€ë¡œ316ë²ˆê¸¸ 22-32",
    x: 127.315865811358,
    y: 36.3948894468174,
    db: 57.45,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ìƒˆì‹¹ì–´ë¦°ì´ì§‘ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ìš©ë¬¸ë¡œ 113",
    x: 127.393815537356,
    y: 36.334479797874,
    db: 60.71,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì„±ê²½ë¹Œë”© ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê³„ë£¡ë¡œ 365-1",
    x: 127.369470207514,
    y: 36.3530394981061,
    db: 71.19,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì‚¼ë¶€4ë‹¨ì§€ì•„íŒŒíŠ¸ 410ë™ ë’·í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ íƒœí‰ë¡œ 55",
    x: 127.391442056788,
    y: 36.3223831728175,
    db: 64.25,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì„±í˜¸ë¹Œë¼ ë’·í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì‹ ê°ˆë§ˆë¡œ 173-13",
    x: 127.367455482172,
    y: 36.3491297234473,
    db: 55.94,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì†¡ì´Œì„œì˜¤ì•„íŒŒíŠ¸ 105ë™ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë™ì¶˜ë‹¹ë¡œ23ë²ˆê¸¸ 37",
    x: 127.445506687067,
    y: 36.3596989384921,
    db: 55.22,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ìŠ¤ìœ„íŠ¸ë¹Œ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ í™ë„ë¡œ 17",
    x: 127.42960213628,
    y: 36.3478097465424,
    db: 64.3,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì‹ ì¼ì´ìš©ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ì¶©ë¬´ë¡œ 112",
    x: 127.429333672168,
    y: 36.3182439613395,
    db: 66.79,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì—‘ìŠ¤í¬ìœ ì¹˜ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì—‘ìŠ¤í¬ë¡œ 448",
    x: 127.409202641349,
    y: 36.3975506025886,
    db: 60.51,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì„¼íŠ¸ëŸ´ìì´ 101ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë³µìˆ˜ì„œë¡œ 15",
    x: 127.371406144697,
    y: 36.3060393211303,
    db: 60.36,
    location: "ì¼ë°˜",
    zone: "ë‚˜"
  },
  {
    name: "ì–´ì€ì–´ë¦°ì´ê³µì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì–´ì€ë™ 108-12",
    x: 127.355792792971,
    y: 36.3626638569664,
    db: 57.64,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì–´ë°˜íìŠ¤ì•„íŒŒíŠ¸ 501ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ë‚¨ë¡œ 80",
    x: 127.342043630219,
    y: 36.2942634124273,
    db: 66.06,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì˜¥ê³„ë™ ì†”ë¹›ì•„íŒŒíŠ¸ 101ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ì˜¥ê³„ë™ 45-3",
    x: 127.454745641488,
    y: 36.2992901504784,
    db: 52.64,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì†Œë¡±ê³¨ ì–´ë¦°ì´ê³µì›(êµ¬, ì• ê²½í™”ì¥í’ˆ)",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ê³„ì¡±ë¡œ608ë²ˆê¸¸ 39-14",
    x: 127.432673910851,
    y: 36.3669555940581,
    db: 55.89,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì•„í”„ë¦¬ì¹´ë™ë¬¼ë©”ë””ì»¬ì„¼í„° ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë¬¸ì •ë¡œ 16",
    x: 127.381737137092,
    y: 36.3454867822582,
    db: 67.84,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì„œë¶€ë†í˜‘ ê´´ì •ì§€ì  ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ì†”ë¡œ 325",
    x: 127.383404151107,
    y: 36.3372117096084,
    db: 66.47,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì˜ˆì€ì¶•ì‚° ë§ì€í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ë¿Œë¦¬ê³µì›ë¡œ23ë²ˆê¸¸ 9",
    x: 127.380435858303,
    y: 36.2859729730668,
    db: 55.71,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ì˜¤ë¥˜ì–´ë¦°ì´ê³µì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ê³„ë£¡ë¡œ816ë²ˆê¸¸",
    x: 127.404920574447,
    y: 36.327017412608,
    db: 55.22,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ìš©ë¬¸ë¹Œë¦¬ì§€ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ìœ ë“±ë¡œ483ë²ˆê¸¸ 38",
    x: 127.392983457601,
    y: 36.333765285871,
    db: 55.56,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì—˜ì¼€ì´íŒ¹í‹°ëª¨ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ë³µìš©ë™ë¡œ 55",
    x: 127.322300705588,
    y: 36.3372638679667,
    db: 57.82,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ìš©ë¬¸ ì˜¤í† ë°”ì´ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì›”í‰ë¡œ 26",
    x: 127.360030880844,
    y: 36.3559162501331,
    db: 62.97,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì˜¬ë¦¬ë¸Œì˜ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ë™ë¡œ 166",
    x: 127.341146619319,
    y: 36.30689081583,
    db: 62.42,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ìš©ì¸ë¹Œë¼ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ì„ í™”ë™ 191-1",
    x: 127.417106631946,
    y: 36.3319801361269,
    db: 53.51,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ìš°ì •ìœ ì¹˜ì› ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ì„œë¡œ 47",
    x: 127.329643944132,
    y: 36.2966074874949,
    db: 62.89,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì˜¨ëˆ„ë¦¬êµíšŒ ìš°ì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ë™ë¶€ë¡œ 39",
    x: 127.457576446156,
    y: 36.3205614530336,
    db: 65.68,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ìš©ìš´ë„ì„œê´€ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ìš©ìš´ë™ 389-2",
    x: 127.4639919269,
    y: 36.3253509908919,
    db: 52.4,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì€í˜œìš”ì–‘ë³‘ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ëŒ€ì‚¬ë™ 248-287",
    x: 127.417093610474,
    y: 36.3193484627972,
    db: 69.27,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì—´ë§¤ë§ˆì„ëŒ€ìš°3ë‹¨ì§€ 307ë™ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ë…¸ì€ë™ë¡œ 219",
    x: 127.319854496386,
    y: 36.3787386745325,
    db: 61.27,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì•„ì´ìˆ˜ì•ˆê²½ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë¬¸ì •ë¡œ 86",
    x: 127.388771037247,
    y: 36.3464570094755,
    db: 69.07,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ìš°ì •ë¹Œë¼ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì‹ ê°ˆë§ˆë¡œ 161",
    x: 127.368069009005,
    y: 36.348195441837,
    db: 66.6,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì´ì„œë¹Œ ìš°ì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì§€ì¡±ë¶ë¡œ13ë²ˆê¸¸ 2",
    x: 127.303067356144,
    y: 36.3867271727369,
    db: 58.34,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì¸ë™ì„±ê²°êµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ì¸ë™ 155-2",
    x: 127.439245625878,
    y: 36.3211282736683,
    db: 55.52,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ìš©ìš´ì´ˆë“±í•™êµ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ìš©ìš´ë™ 303",
    x: 127.463934765084,
    y: 36.3265558492224,
    db: 58.42,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì¡±ìš•ì²´í—˜ì¥ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì˜¨ì²œë¡œ 60",
    x: 127.344242361402,
    y: 36.3544548609713,
    db: 63.51,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ìœ ì„±ì˜¨ì²œêµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ìœ ì„±ëŒ€ë¡œ 743",
    x: 127.333764294813,
    y: 36.3594149040178,
    db: 65.81,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì¥ëŒ€ì´ˆë“±í•™êµ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ë¬¸í™”ì›ë¡œ19ë²ˆê¸¸ 16",
    x: 127.339885744782,
    y: 36.3617977040082,
    db: 66.33,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ìœ—ìš©ì†Œì–´ë¦°ì´ê³µì›",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ì•ˆë™ë¡œ11ë²ˆê¸¸",
    x: 127.350882548215,
    y: 36.3058423939249,
    db: 60.24,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì°¸ë™ë¬¼ë³‘ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ì‚°ë¡œ 82",
    x: 127.379125187111,
    y: 36.3157769341184,
    db: 68.64,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì˜¥ë´‰í™”í•™ ì •ë¬¸ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¬¸í‰ë™ë¡œ48ë²ˆê¸¸ 1",
    x: 127.400967712734,
    y: 36.4486745452149,
    db: 60.64,
    location: "ë„ë¡œ",
    zone: "ë‹¤"
  },
  {
    name: "ì •ë¦¼ì´ˆêµ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì •ë¦¼ì„œë¡œ 162-15",
    x: 127.365515183789,
    y: 36.303102216601,
    db: 62.89,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì²œê´‘êµíšŒ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ëŒ€ë™ì´ˆë“±1ê¸¸ 36",
    x: 127.447623815564,
    y: 36.3247167110191,
    db: 55.69,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì°½ì›ë¹Œë¼ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ë¬¸í™”ì›ë¡œ10ë²ˆê¸¸ 51",
    x: 127.338033020606,
    y: 36.3594195743835,
    db: 56.68,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì²­ì£¼ì‹ë‹¹ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ê°€ì–‘ë™ 293-9",
    x: 127.442233535069,
    y: 36.3426210821096,
    db: 61.55,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì¥ëŒ€ë…¸ì¸íšŒê´€ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ìœ ì„±ëŒ€ë¡œ758ë²ˆê¸¸ 28",
    x: 127.335560551199,
    y: 36.3589182004013,
    db: 58.73,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì´ˆëŒ€êµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ í•œë°­ëŒ€ë¡œ1237ë²ˆê¸¸ 37-24",
    x: 127.436202057028,
    y: 36.3589685662892,
    db: 53.73,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì§„ì í–¥êµ ì˜†",
    addr: "ëŒ€ì „ ìœ ì„±êµ¬ êµì´Œë¡œ 67",
    x: 127.315024718849,
    y: 36.3036785561973,
    db: 53.08,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "ì¤‘ì´Œ ê²½í¬í•œì˜ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ íƒœì „ë¡œ 149",
    x: 127.42049575923,
    y: 36.3409788709856,
    db: 70.59,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì›”í‰2ë™ìš°ì²´êµ­ ì•",
    addr: "ëŒ€ì „ ì„œêµ¬ ê°ˆë§ˆì—­ë¡œ 143-12",
    x: 127.373667822204,
    y: 36.3635676730267,
    db: 60.65,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì¼€ì´ë²¨ ìš°ì¸¡ ë„ë¡œë³€",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ í…Œí¬ë…¸1ë¡œ 11-8",
    x: 127.389909453786,
    y: 36.4319513366356,
    db: 63.47,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì²­ì¶˜ë‹¤ë½ ì•(êµ¬, ì¤‘ì•™ë™ì‚¬ë¬´ì†Œ ì•)",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ì„ í™”ë¡œ196ë²ˆê¸¸ 56",
    x: 127.429126002776,
    y: 36.3317369825906,
    db: 54.64,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì»¤í”¼ê°€ì£¼ì°¨ì¥ ì¢Œì¸¡",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ íƒ‘ë¦½ë™ 624-10",
    x: 127.395459144032,
    y: 36.4090985977428,
    db: 63.6,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì¶©ì¼êµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ì˜¥ê³„ë™ 173-1",
    x: 127.452225190944,
    y: 36.296286266498,
    db: 71.66,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "í¬ë¦°ì•„ì´ ë§ì€í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„ì†”ë¡œ327ë²ˆê¸¸ 12",
    x: 127.383201215445,
    y: 36.3377063138227,
    db: 56.68,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì½”ì¸ì›Œì‹œ365 ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ê°€ì–‘ë¡œ80ë²ˆê¸¸ 23",
    x: 127.443088542482,
    y: 36.3425432650717,
    db: 55.86,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì²­ë£¡ì•„íŒŒíŠ¸1ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ë™ì‚°ì´ˆêµë¡œ22ë²ˆê¸¸ 15",
    x: 127.427573013343,
    y: 36.347561444337,
    db: 56.2,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "íˆ¬ì¸í”Œë ˆì´ìŠ¤ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì€êµ¬ë¹„ì„œë¡œ23ë²ˆê¸¸ 15",
    x: 127.319677282836,
    y: 36.3742209952457,
    db: 61.23,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í•˜ë‚˜ë¡œì•„íŒŒíŠ¸ 110ë™ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì²­ì‚¬ë¡œ 5",
    x: 127.365037321587,
    y: 36.3611513895089,
    db: 67.55,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì¤‘ì•™ì‹œì¥ê³µìš©ì£¼ì°¨ì¥ë¹Œë”© ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ì¤‘ì•™ë¡œ200ë²ˆê¸¸ 70",
    x: 127.432737917859,
    y: 36.3274171704018,
    db: 58.76,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í•œë¹›êµíšŒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ëŒ€ë•ëŒ€ë¡œ22ë²ˆê¸¸ 21",
    x: 127.373538444669,
    y: 36.3349616646714,
    db: 55.02,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "í¬ë„ê³¼ìˆ˜ì› ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì—‘ìŠ¤í¬ë¡œ539ë²ˆê¸¸ 201-7",
    x: 127.395709773858,
    y: 36.4083252687925,
    db: 52.24,
    location: "ë„ë¡œ",
    zone: "ë¼"
  },
  {
    name: "í•œë°­ì£¼íƒ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì˜¤ëŸ‰3ê¸¸ 32",
    x: 127.376388337207,
    y: 36.3096594210792,
    db: 51.86,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "í•˜ë²„ë“œì‚¬ì§„ê´€ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¹„ë˜ë™ë¡œ 26",
    x: 127.450524104151,
    y: 36.3561982115464,
    db: 61.86,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í•œí¬ìˆ˜ ê°œì„±ë§Œë‘ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ í•œë°­ëŒ€ë¡œ 1221",
    x: 127.434069662139,
    y: 36.3583463321635,
    db: 71.41,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í•œë¹›ìˆœë³µìŒêµíšŒ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì¤‘ë°˜8ê¸¸ 79",
    x: 127.385399103885,
    y: 36.3272903266094,
    db: 54.08,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "í°ì†”ì•„íŒŒíŠ¸ ë§ì€í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ë™ëŒ€ì „ë¡œ256ë²ˆê¸¸ 109",
    x: 127.452083233362,
    y: 36.3468423163945,
    db: 53.94,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "í•´ì„±ë¹Œë¼ ìš°ì¸¡í¸",
    addr: "ëŒ€ì „ ì„œêµ¬ ë„ì†”ë¡œ 112",
    x: 127.373800364562,
    y: 36.3205373846535,
    db: 64.81,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "í•´ì˜¤ë¦„ë¹Œ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ í™ë„ë¡œ129ë²ˆê¸¸ 89",
    x: 127.422148945433,
    y: 36.3575083201328,
    db: 53.97,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ì´ˆë¡ë§ˆì„ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì›ë„ì•ˆë¡œ 183",
    x: 127.343785969817,
    y: 36.320135133039,
    db: 63.78,
    location: "ë„ë¡œ",
    zone: "ê°€"
  },
  {
    name: "í™ì£¼ë„¤ì‹ë‹¹ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ë™êµ¬ ëŒ€ì „ë¡œ 680-4",
    x: 127.438448759347,
    y: 36.32101076503,
    db: 67.75,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í•´ì˜ìš° ë¹Œë”© ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ì›ë„ì•ˆë¡œ179ë²ˆê¸¸ 30-9",
    x: 127.342078226335,
    y: 36.3196849862513,
    db: 62.09,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ìƒë¡ìŠ¤í† ì•„",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë‘”ì‚°ë™ 908",
    x: 127.393145415941,
    y: 36.3612128616922,
    db: 61.84,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ìœ ì§„íˆ¬ìì¦ê¶Œ",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë‘”ì‚°ë™ 1273",
    x: 127.380979746938,
    y: 36.3515684811983,
    db: 68.31,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í˜¸ìˆ˜ì‹ë‹¹ ë§ì€í¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ í‰ì´Œ2ê¸¸ 25",
    x: 127.434586372253,
    y: 36.4365935166639,
    db: 54.87,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í˜„ëŒ€í•´ìƒ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë‘”ì‚°ì„œë¡œ 75",
    x: 127.382595982164,
    y: 36.353294392513,
    db: 65.14,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "íœ´ë¨¼ì‹œì•„4ë‹¨ì§€ì•„íŒŒíŠ¸ 401ë™ ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ìƒëŒ€ë¡œ 40",
    x: 127.338460561269,
    y: 36.3473304385587,
    db: 62.6,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "í™”ë¡œì—°ë‹´ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì›ì‹ í¥ë‚¨ë¡œ 27",
    x: 127.337940802084,
    y: 36.335080680202,
    db: 57.39,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í•´ëœ°ë§ˆì„ ì–´ë¦°ì´ë„ì„œê´€ ì˜†",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ê´€ì €ë™ë¡œ 166",
    x: 127.341146619319,
    y: 36.30689081583,
    db: 58.6,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "í•˜ë‚˜ë¡œì •ìœ¡ì‹ë‹¹ ê±´ë„ˆí¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ë™ì„œëŒ€ë¡œ 1190",
    x: 127.392130740494,
    y: 36.326291974121,
    db: 70.72,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "í˜„ëŒ€ìë™ì°¨ëŒ€ì „ëŒ€í™”ëŒ€ë¦¬ì  ì•",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ëŒ€í™”ë™ 16-236",
    x: 127.419027705261,
    y: 36.3669211469102,
    db: 71.63,
    location: "ë„ë¡œ",
    zone: "ë‚˜"
  },
  {
    name: "ì—´ë§¤ë§ˆì„7ë‹¨ì§€ ì •ë¬¸",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ìœ ì„±êµ¬ ì§€ì¡±ë™ ì€êµ¬ë¹„ë¡œ 55",
    x: 127.320850266538,
    y: 36.3757375841407,
    db: 63.13,
    location: "ì¼ë°˜",
    zone: "ê°€"
  },
  {
    name: "ë™ëŒ€ì „ì‚°ì •í˜„êµíšŒ",
    addr: "ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ìŒì²­ë‹¹ë¡œ35ë²ˆê¸¸ 26",
    x: 127.433066221542,
    y: 36.3652344066075,
    db: 59.63,
    location: "ë„ë¡œ",
    zone: "ê°€"
  }
];

  window.toggleMarkers = function () {
    if (isMarkerVisible) {
      clearMarkers();
      isMarkerVisible = false;
    } else {
      showMarkers();
      isMarkerVisible = true;
    }
  };
  window.closeOverlay = function () {
    if (window.overlay) {
      window.overlay.setMap(null);
    }
  };

  function showMarkers() {
    clearMarkers();
    markerPoints.forEach(pt => {
      const marker = new kakao.maps.Marker({
        map,
        position: new kakao.maps.LatLng(pt.y, pt.x),
        title: pt.name,
        image: noiseIcon
      });
      kakao.maps.event.addListener(marker, 'click', () => {
        overlay.setContent(createNoiseOverlay(pt));
        overlay.setPosition(marker.getPosition());
        overlay.setMap(map);
      });
      markerData.push(marker);
    });
  }

  function clearMarkers() {
    markerData.forEach(m => m.setMap(null));
    markerData = [];
    overlay.setMap(null);
  }
  
  function markerClickHandler(marker, properties) {
    const lat = marker.getPosition().getLat();
    const lng = marker.getPosition().getLng();

    // íŒì—… ë„ìš°ê¸°
    $('#buildingInfoPopup').fadeIn(() => {
      showPopupMap(lat, lng); // âœ… í´ë¦­ëœ ë§ˆì»¤ ì¢Œí‘œë¥¼ íŒì—… ì§€ë„ì— í‘œì‹œ
    });

    $('body').css('overflow', 'hidden');

    // ìƒì„¸ ì •ë³´ ì±„ìš°ê¸°
    $('#buildingName').text(properties.cmpx_nm || 'ë‹¨ì§€ëª… ì •ë³´ ì—†ìŒ');
    $('#buildingAddress').text(properties.rd_addr || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ');
    $('#wishIcon').attr('data-cmpxcd', properties.cmpx_cd || '');

    $('#unitTotal').text(properties.hhld_cnt || 'ì •ë³´ ì—†ìŒ');
    $('#buildingCount').text(properties.bld_cnt || 'ì •ë³´ ì—†ìŒ');
    $('#floorMax').text(properties.flr_max || 'ì •ë³´ ì—†ìŒ');
    $('#cctvCount').text(properties.cctv || 'ì •ë³´ ì—†ìŒ');
    $('#areaUnit').text(properties.area_per_hhld || 'ì •ë³´ ì—†ìŒ');

    $('#builtDate').text(properties.built_ym ? `${properties.built_ym} ì¤€ê³µ` : '');

    createEnergyGauge(properties.energy || null);
    renderManagementCharts();
  }
  

window.searchBuilding = function () {
  const keywordInput = document.getElementById('searchInput');
  const keyword = keywordInput.value.trim();

  if (!keyword) {
    alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }

  clearPolygons();
  clearMarkers();

  let bounds = new kakao.maps.LatLngBounds();
  let found = false;

  fetch(`/searchKeyword?keyword=${encodeURIComponent(keyword)}`)
    .then(response => {
      if (!response.ok) throw new Error('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜');
      return response.json();
    })
    .then(data => {
      const geocoder = new kakao.maps.services.Geocoder();

      if (data.length === 0) {
        alert("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }

      const address = data[0].rdAddr;
      if (address) {
        geocoder.addressSearch(address, function (result, status) {
          if (status === kakao.maps.services.Status.OK) {
            const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
            map.setCenter(coords);
          }
        });
      }

      data.forEach(item => {
        const address = item.rdAddr;
        if (!address) return;

        geocoder.addressSearch(address, function (result, status) {
          if (status === kakao.maps.services.Status.OK) {
            const coords = new kakao.maps.LatLng(result[0].y, result[0].x);

            const marker = new kakao.maps.Marker({
              map: map,
              position: coords,
              title: item.cmpxNm || address
            });

            markerData.push(marker);
            searchMarkers.push(marker);

            kakao.maps.event.addListener(marker, 'click', function () {
				$('#buildingInfoPopup').show().fadeIn();
				$('body').css('overflow', 'hidden');
				$('.icons-menu .icon-item').removeClass('active');
				$('.icons-menu .icon-item[data-target="section-management-fee"]').addClass('active');
				$('.popup-scroll-content').scrollTop(0);

				// âœ… [ìˆ˜ì •] ì•„íŒŒíŠ¸ ì´ë¦„ìœ¼ë¡œ ì—ë„ˆì§€ íš¨ìœ¨ ë“±ê¸‰ê³¼ ì†Œìš”ëŸ‰ì„ ì¡°íšŒí•˜ëŠ” AJAX í˜¸ì¶œ
				$.ajax({
				      url: '/api/energyScoreByName',      // ì„œë²„ì— ìš”ì²­í•  ì£¼ì†Œ
				      method: 'GET',
				      data: { cmpxCd: item.cmpxCd },      // í´ë¦­ëœ ë§ˆì»¤ì˜ ì•„íŒŒíŠ¸ ì´ë¦„ì„ íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡
				      dataType: 'json',
				      success: function(energyData) {     // ìš”ì²­ì´ ì„±ê³µí•˜ë©´ energyDataì— ê²°ê³¼ê°€ ë‹´ê¹€
						console.log(energyData);
				        // ë°›ì€ ë°ì´í„°ë¡œ íŒì—…ì°½ì˜ HTML ìš”ì†Œë¥¼ ì°¾ì•„ í…ìŠ¤íŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
				        $('#energyGrade').text(`ì´ ê±´ë¬¼ì˜ ì—ë„ˆì§€ íš¨ìœ¨ ë“±ê¸‰ì€ "${energyData.energyGrade || 'ì •ë³´ ì—†ìŒ'}" ì…ë‹ˆë‹¤.`);
				        $('#energyReq').text(`ì—ë„ˆì§€ ì†Œìš”ëŸ‰: ${energyData.energyReq || '-'}`);
				        $('#matchedBldName').text(`ë§¤ì¹­ëœ ì¸ì¦ ê±´ë¬¼: ${energyData.bldName || 'ì—†ìŒ'}`);
				        
				        // ë°›ì€ ë“±ê¸‰ ì •ë³´ë¡œ ì—ë„ˆì§€ ê²Œì´ì§€ ì°¨íŠ¸ë¥¼ ë‹¤ì‹œ ê·¸ë¦½ë‹ˆë‹¤.
				        createEnergyGaugeByGrade(energyData.energyGrade || "ì •ë³´ ì—†ìŒ");
				      },
				      error: function(err) {
				        // ì„œë²„ ìš”ì²­ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê³ , ê²Œì´ì§€ ì°¨íŠ¸ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
				        console.error("ì—ë„ˆì§€ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:", err);
				        $('#energyGrade').text(`ì´ ê±´ë¬¼ì˜ ì—ë„ˆì§€ íš¨ìœ¨ ë“±ê¸‰ì€ "ì •ë³´ ì—†ìŒ" ì…ë‹ˆë‹¤.`);
				        $('#energyReq').text(`ì—ë„ˆì§€ ì†Œìš”ëŸ‰: -`);
				        $('#matchedBldName').text(`ë§¤ì¹­ëœ ì¸ì¦ ê±´ë¬¼: ì—†ìŒ`);
				        createEnergyGaugeByGrade("ì •ë³´ ì—†ìŒ");
				      }
				    });
              // âœ… popupMap ì§€ë„ ìƒì„±
			  createPopupMap(result[0].y, result[0].x);

			  fetch(`/api/complexDetail?cmpxCd=${encodeURIComponent(item.cmpxCd)}`)
			    .then(res => res.json())
				.then(detail => {
				    console.log("ğŸ”¥ detail.similarList =", detail.similarList); // ì´ê±° ì°ì–´ë³´ì„¸ìš”
				  $('#toggle-wish-icon').data('cmpxcd', item.cmpxCd);
			      $('#buildingName').text(detail.mapVo.cmpxNm || 'ë‹¨ì§€ëª… ì—†ìŒ');
			      $('#buildingAddress').text(detail.mapVo.lglAddr || 'ì£¼ì†Œ ì—†ìŒ');
			      $('#builtDate').text(detail.mapVo.apprDt ? detail.mapVo.apprDt + ' ì¤€ê³µ' : 'ì •ë³´ ì—†ìŒ');

			      $('#unitTotal').text(detail.mapVo.unitTot ?? 'ì •ë³´ ì—†ìŒ');
			      $('#buildingCount').text(detail.mapVo.bldgCnt ?? 'ì •ë³´ ì—†ìŒ');
			      $('#floorMax').text(detail.mapVo.flrMax ?? 'ì •ë³´ ì—†ìŒ');
			      $('#cctvCount').text(detail.mapVo.cctvCnt ?? 'ì •ë³´ ì—†ìŒ');
			      $('#areaUnit').text(detail.areaVo?.areaUnit ?? 'ì •ë³´ ì—†ìŒ');

			      $('#avgMgmtFee').text(detail.unitFee !== null ? detail.unitFee.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#publicMgmtFee').text(detail.publicMgmtFee !== null ? detail.publicMgmtFee.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#personalMgmtFee').text(detail.personalMgmtFee !== null ? detail.personalMgmtFee.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');

			      $('#mgmtFeeTotal').text(detail.mgmtFeeTotalInt !== null ? detail.mgmtFeeTotalInt.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#cleaningFee').text(detail.cleaningFeeInt !== null ? detail.cleaningFeeInt.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#securityFee').text(detail.securityFeeInt !== null ? detail.securityFeeInt.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#disinfectionFee').text(detail.disinfectionFeeInt !== null ? detail.disinfectionFeeInt.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#elevatorMaintFee').text(detail.elevatorMaintFeeInt !== null ? detail.elevatorMaintFeeInt.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#repairFee').text(detail.repairFeeInt !== null ? detail.repairFeeInt.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');

			      $('#electricFee').text(detail.elecUsagePrivatePerUnit !== null ? Math.round(detail.elecUsagePrivatePerUnit).toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#waterFee').text(detail.waterUsagePrivatePerUnit !== null ? Math.round(detail.waterUsagePrivatePerUnit).toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#heatingFee').text(detail.heatingFeePrivatePerUnit !== null ? Math.round(detail.heatingFeePrivatePerUnit).toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');
			      $('#gasFee').text(detail.gasUsagePrivatePerUnit !== null ? Math.round(detail.gasUsagePrivatePerUnit).toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ');

			      // ìœ ì‚¬ ë‹¨ì§€ ë¦¬ìŠ¤íŠ¸ ì¶”ê°€: #similarComplexList ìš”ì†Œì— ë™ì ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ ìƒì„±
				  const similarListContainer = $('.similar-building-list');
				  similarListContainer.empty(); // ê¸°ì¡´ ë‚´ìš© ë¹„ìš°ê¸°

				  const listToUse = detail.similarList || similarList; // ë‘˜ ì¤‘ì— ìˆëŠ” ë°ì´í„° ì„ íƒ
				  const fallbackImages = ['doan19.jpg', 'haerangsoop.jpg', 'richeville.jpg']; // chunnyunnamu ì œì™¸

				  if (listToUse && listToUse.length > 0) {
				    listToUse.forEach(item => {
				      // imageUrlì´ ì—†ìœ¼ë©´ ëœë¤ ì´ë¯¸ì§€ ì„ íƒ
				      const imageFile = item.imageUrl || fallbackImages[Math.floor(Math.random() * fallbackImages.length)];
				      const cardHtml = `
				        <div class="image-container">
				          <img src="/img/apt/${imageFile}" alt="${item.cmpxNm} Image">
				          <div class="details">
				            <h6>${item.cmpxNm}</h6>
				            <p>${item.lglAddr || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ'}</p>
				            <p>${item.age || '-'}ë…„ì°¨ / ${item.unitTot || '-'}ì„¸ëŒ€</p>
				          </div>
				        </div>
				      `;
				      similarListContainer.append(cardHtml);
				    });
				  } else {
				    similarListContainer.html('<p>ìœ ì‚¬ ë‹¨ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>');
				  }

			      // ê´€ë¦¬ë¹„, ì—ë„ˆì§€ ì°¨íŠ¸ ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œ
			      managementFees = {
			        total: detail.mgmtFeeTotalInt ?? 0,
			        cleaning: detail.cleaningFeeInt ?? 0,
			        security: detail.securityFeeInt ?? 0,
			        disinfection: detail.disinfectionFeeInt ?? 0,
			        elevator: detail.elevatorMaintFeeInt ?? 0,
			        repair: detail.repairFeeInt ?? 0
			      };

			      energyCosts = {
			        elec: detail.elecUsagePrivatePerUnit ?? 0,
			        water: detail.waterUsagePrivatePerUnit ?? 0,
			        heating: detail.heatingFeePrivatePerUnit ?? 0,
			        gas: detail.gasUsagePrivatePerUnit ?? 0
			      };

			      renderManagementCharts();
			    })
			    .catch(err => console.error("ê±´ë¬¼ ìƒì„¸ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨", err));
            });
          }
        });
      });
    })
    .catch(error => {
      console.error('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
    });
};

document.getElementById('searchInput').addEventListener('keydown', function (event) {
  if (event.key === 'Enter') {
    event.preventDefault();
    window.searchBuilding();
  }
});

function createPopupMap(lat, lng) {
  const container = document.getElementById('popupMap');
  if (!container) return;

  container.innerHTML = ""; // í˜¹ì‹œ ì´ì „ ì§€ë„ê°€ ìˆì„ ê²½ìš° ì´ˆê¸°í™”

  const options = {
    center: new kakao.maps.LatLng(lat, lng),
    level: 3
  };

  const popupMap = new kakao.maps.Map(container, options);

  const marker = new kakao.maps.Marker({
    position: new kakao.maps.LatLng(lat, lng)
  });
  marker.setMap(popupMap);
}

// DBì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¡œ í´ë¦¬ê³¤ ê·¸ë¦¬ëŠ” í•¨ìˆ˜
  function drawPolygonsFromDB(itemList) {
    itemList.forEach(item => {
      try {
        const raw = item.cords;
        if (!raw) return;

        let parsed = typeof raw === 'string' ? JSON.parse(raw) : raw;
        let geometry = typeof parsed === 'string' ? JSON.parse(parsed) : parsed;

        let coords = [];
        if (geometry.type === 'Polygon') {
          coords = geometry.coordinates[0]
            .filter(e => Array.isArray(e) && !isNaN(e[0]) && !isNaN(e[1]))
            .map(e => new kakao.maps.LatLng(e[1], e[0]));
        } else if (geometry.type === 'MultiPolygon') {
          coords = geometry.coordinates[0][0]
            .filter(e => Array.isArray(e) && !isNaN(e[0]) && !isNaN(e[1]))
            .map(e => new kakao.maps.LatLng(e[1], e[0]));
        } else {
          console.warn("ì§€ì›ë˜ì§€ ì•ŠëŠ” í˜•ì‹:", geometry.type);
          return;
        }

        if (coords.length < 3) return;

        const polygon = new kakao.maps.Polygon({
          path: coords,
          strokeWeight: 2,
          strokeColor: '#004c80',
          strokeOpacity: 0.8,
          fillColor: '#a6c1ee',
          fillOpacity: 0.6
        });

        polygon.setMap(map);
        polygons.push(polygon);

      } catch (err) {
        console.error("ì¢Œí‘œ íŒŒì‹± ì˜¤ë¥˜:", err);
      }
    });
  }
  
  function createEnergyGaugeByGrade(grade) {
    const scoreMap = {
      "1+++": 50, "1++": 75, "1+": 100, "1": 130,
      "2": 170, "3": 210, "4": 250, "5": 290,
      "6": 330, "7": 370
    };
    const score = scoreMap[grade] ?? 420; // ì •ë³´ ì—†ìŒ ë˜ëŠ” ê¸°íƒ€ ë“±ê¸‰ì¼ ë•Œ

    createEnergyGauge(score); // ê¸°ì¡´ ê²Œì´ì§€ ì°¨íŠ¸ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ í˜¸ì¶œ

    $('#energyGrade').text(`ì´ ê±´ë¬¼ì˜ ì—ë„ˆì§€ íš¨ìœ¨ ë“±ê¸‰ì€ "${grade}" ì…ë‹ˆë‹¤.`);
  }
  


});
